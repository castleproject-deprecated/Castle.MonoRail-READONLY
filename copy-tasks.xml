<?xml version="1.0" encoding='iso-8859-1' ?>
<project name="all" default="build">

	<property name="base.dir" value="${path::get-full-path( project::get-base-directory() )}" />
	<property name="sharedlibrary.dir" value="${base.dir}/SharedLibs" />

	<!-- castle's assemblies location -->
	<property name="castle.ar" value="${base.dir}/ActiveRecord/bin/Castle.ActiveRecord.dll" />
	<property name="castle.core" value="${base.dir}/Core/bin/Castle.Core.dll" />
	<property name="castle.kernel" value="${base.dir}/InversionOfControl/bin/Castle.MicroKernel.dll" />
	<property name="castle.windsor" value="${base.dir}/InversionOfControl/bin/Castle.Windsor.dll" />
	<property name="castle.dynamicproxy" value="${base.dir}/Tools/DynamicProxy/bin/Castle.DynamicProxy.dll" />
	<property name="castle.transaction-service" value="${base.dir}/Services/bin/Castle.Services.Transaction.dll" />
	<property name="castle.security-service" value="${base.dir}/Services/bin/Castle.Services.Security.dll" />

	<!-- tasks to copy castle's assemblies -->

	<target name="copy-castle.core">
		<copy file="${castle.core}" todir="${bin.dir}" />
	</target>
	
	<target name="copy-dynamicproxy">
		<copy file="${castle.dynamicproxy}" todir="${bin.dir}" />
	</target>
	
	<target name="copy-container" depends="copy-castle.core, copy-dynamicproxy">
		<copy file="${castle.kernel}" todir="${bin.dir}" />
		<copy file="${castle.windsor}" todir="${bin.dir}" />
	</target>
	
	<target name="copy-templateengine-comp" depends="copy-nvelocity">
		<copy todir="${bin.dir}">
			<fileset basedir="${base.dir}/Components/General/TemplateEngine/bin">
				<include name="Castle.Components.Common.TemplateEngine.dll" />
				<include name="Castle.Components.Common.TemplateEngine.NVelocityTemplateEngine.dll" />
			</fileset>
		</copy>
	</target>

	<target name="copy-email-comp">
		<copy todir="${bin.dir}">
			<fileset basedir="${base.dir}/Components/General/EmailSender/bin">
				<include name="Castle.Components.Common.EmailSender.dll" />
				<include name="Castle.Components.Common.EmailSender.SmtpEmailSender.dll" />
			</fileset>
		</copy>
	</target>

	<target name="copy-binder-comp">
		<copy file="${base.dir}/Components/General/Binder/bin/Castle.Components.Binder.dll" todir="${bin.dir}" />
	</target>

	<target name="copy-activerecord" depends="copy-nhibernate">
		<copy file="${castle.ar}" todir="${bin.dir}" />
	</target>
	
	<target name="copy-transaction-service" depends="copy-logging-service">
		<copy file="${castle.transaction-service}" todir="${bin.dir}" />
	</target>

	<target name="copy-security-service">
		<copy file="${castle.security-service}" todir="${bin.dir}" />
	</target>

	<target name="copy-atm-facility">
		<copy todir="${bin.dir}">
			<fileset basedir="${base.dir}/Facilities/AutomaticTransactionManagement/bin">
				<include name="Castle.Facilities.AutomaticTransactionManagement.dll" />
			</fileset>
		</copy>
	</target>

	<target name="copy-aspectsharp" depends="copy-dynamicproxy">
		<copy todir="${bin.dir}">
			<fileset basedir="${base.dir}/AspectSharp/bin">
				<include name="antlr.runtime.dll" />
				<include name="AopAlliance.dll" />
				<include name="AspectSharp.dll" />
				<include name="AspectSharp.Lang.dll" />
			</fileset>
		</copy>
	</target>

	<target name="copy-logging-service">
		<copy todir="${bin.dir}">
			<fileset basedir="${base.dir}/Services/bin">
				<include name="Castle.Services.Logging.dll" />
				<include name="Castle.Services.Logging.Log4netIntegration.dll" />
				<include name="Castle.Services.Logging.NLogIntegration.dll" />
			</fileset>
		</copy>
	</target>

	<!-- tasks to copy shared libs -->

	<target name="copy-nhibernate" depends="copy-log4net, copy-dynamicproxy">
		<copy todir="${bin.dir}">
			<fileset basedir="${sharedlibrary.dir}/nhibernate">
				<include name="*.dll" />
			</fileset>
		</copy>
		<copy todir="${bin.dir}" if="${framework::get-target-framework()=='net-2.0'}">
			<fileset basedir="${base.dir}/Experiments/NHibernate.Nullables2/bin">
				<include name="NHibernate.Nullables2.dll" />
			</fileset>
		</copy>
	</target>

	<target name="copy-nullables">
		<copy todir="${bin.dir}">
			<fileset basedir="${sharedlibrary.dir}/nhibernate">
				<include name="Nullables.dll" />
			</fileset>
		</copy>
	</target>
	
	<target name="copy-log4net">
		<copy todir="${bin.dir}">
			<fileset basedir="${sharedlibrary.dir}/log4net">
				<include name="*.dll" />
			</fileset>
		</copy>
	</target>

	<target name="copy-nlog">
		<copy todir="${bin.dir}">
			<fileset basedir="${sharedlibrary.dir}/nlog">
				<include name="*.dll" />
			</fileset>
		</copy>
	</target>

	<target name="copy-netron">
		<copy todir="${bin.dir}">
			<fileset basedir="${sharedlibrary.dir}/netron">
				<include name="*.dll" />
			</fileset>
		</copy>
	</target>

	<target name="copy-stringtemplate">
		<copy todir="${bin.dir}">
			<fileset basedir="${sharedlibrary.dir}/stringtemplate/${framework::get-target-framework()}">
				<include name="*.dll" />
			</fileset>
		</copy>
	</target>

	<target name="copy-nvelocity">
		<copy todir="${bin.dir}">
			<fileset basedir="${base.dir}/Tools/NVelocity/bin">
				<include name="*.dll" />
			</fileset>
		</copy>
	</target>

	<target name="copy-boo">
		<copy todir="${bin.dir}">
			<fileset basedir="${sharedlibrary.dir}/boo">
				<include name="*.dll" />
			</fileset>
		</copy>
	</target>
	
	<target name="copy-db4o">
		<copy todir="${bin.dir}">
			<fileset basedir="${sharedlibrary.dir}/db4o/${framework::get-target-framework()}">
				<include name="*.dll" />
			</fileset>
		</copy>
	</target>
	
	<target name="copy-ibatis">
		<copy todir="${bin.dir}">
			<fileset basedir="${sharedlibrary.dir}/ibatis/net-1.0">
				<include name="*.dll" />
			</fileset>
		</copy>
	</target>
	
	<target name="copy-prevalence">
		<copy todir="${bin.dir}">
			<fileset basedir="${sharedlibrary.dir}/prevalence">
				<include name="*.dll" />
			</fileset>
		</copy>
	</target>
	
</project>
